# step2

提问：看着可行～，我们先继续讨论下，是否可以先实现除了子应用模板之外的功能？让这些功能更加通用？

完全可以，优先实现通用功能是更优策略，能先沉淀出跨项目复用的规范工具链，后续对接微前端子应用模板时会更灵活，还能覆盖团队其他非微前端项目的需求。

### 一、通用功能先行的核心价值
1. **复用范围更广**：通用的规范工具链（如团队ESLint规则、CLI接入能力）可覆盖团队所有项目，包括普通Vue3项目、React项目等，不止局限于微前端子应用，价值最大化。
2. **降低开发风险**：先落地通用功能，能更早让团队成员试用并反馈问题（如规则是否合理、CLI操作是否流畅），后续叠加子应用模板时，基础工具链已稳定，减少返工。
3. **维护成本更低**：通用功能与子应用模板解耦后，后续更新规范（如调整ESLint规则）只需修改通用包，无需改动模板，降低长期维护成本。

### 二、通用功能与专属功能的拆分
需先明确哪些功能可通用、哪些属于微前端子应用专属，避免通用功能绑定特定场景。

| 功能类别 | 具体内容 | 核心特点 |
|----------|----------|----------|
| **通用功能（优先实现）** | 1. 团队规范规则库：`@team/eslint-config`、`@team/stylelint-config`、`@team/prettier-config`、`@team/commitlint-config` <br> 2. CLI核心工具：交互式初始化规范配置、一键接入规范、存量项目扫描/修复、版本更新检测 <br> 3. 提交规范：husky + commitlint 的通用集成逻辑 | 不绑定任何项目框架/架构，所有前端项目均可使用 |
| **专属功能（后续实现）** | 1. 微前端子应用模板：包含qiankun生命周期配置、webpack适配qiankun的基础配置 <br> 2. CLI模板选项：在通用CLI基础上，新增“微前端子应用”的初始化选项，动态注入qiankun相关配置 | 仅服务于微前端子应用，依赖通用功能的基础能力 |

### 三、调整后的计划步骤（通用功能先行）
#### 第一步：需求与架构预设计（聚焦通用边界）
- 明确通用功能的适配范围：确定支持的项目类型（如Vue3、React，根据团队实际情况），避免规则或CLI逻辑绑定单一框架。
- 优化Monorepo包拆分：确保通用包（如`@team/cli`、`@team/eslint-config`）与后续的子应用模板包（如`@team/template-vue3-qiankun`）完全独立，通过CLI参数关联。
- 制定通用配置的扩展规则：比如`@team/eslint-config`支持“基础版”“Vue3版”“React版”，让不同项目可按需引入，而非一刀切。

#### 第二步：通用规范规则库定制（核心通用能力）
- 按“通用基础+框架扩展”设计规则包：
  1. 先做`@team/eslint-config-base`：包含通用JS/TS规则（如变量命名、代码复杂度），不依赖任何框架。
  2. 再做框架扩展包：如`@team/eslint-config-vue3`（继承base，新增Vue3专属规则）、`@team/eslint-config-react`（如需），后续子应用模板直接用`vue3`扩展包。
- 统一其他规范包：`@team/stylelint-config`（支持CSS/SCSS通用规则）、`@team/prettier-config`（通用格式化规则）、`@team/commitlint-config`（通用提交规范），确保所有包可单独安装使用。

#### 第三步：通用CLI工具核心开发
- 剥离微前端模板相关逻辑，先实现3大通用命令：
  1. `team-cli init`：交互式询问项目类型（Vue3/React），自动生成对应框架的Lint配置文件，安装通用规范包，添加`lint`/`lint:fix`脚本。
  2. `team-cli lint fix`：扫描当前项目代码，自动修复可修复的Lint问题，支持指定规则包。
  3. `team-cli check-update`：单独提供版本检测命令，也可在CLI启动时自动触发，提示通用包或CLI本身的更新。
- 预留模板扩展接口：在CLI代码中预留“模板类型”参数（如`--template qiankun`），后续接入子应用模板时只需新增模板渲染逻辑，无需重构现有代码。

#### 第四步：通用功能测试与团队落地
- 找团队非微前端项目试用：让普通Vue3项目接入通用CLI和规范包，验证功能是否正常（如Lint能检测问题、fix能修复、提交规范能生效）。
- 收集反馈迭代通用功能：根据试用情况调整规则（如放宽过严的规则）、优化CLI交互（如减少不必要的提问步骤），确保通用功能足够成熟。

#### 第五步：微前端子应用模板封装（基于通用能力）
- 基于通用工具链搭建模板：在模板中直接引入`@team/eslint-config-vue3`等通用包，无需重复写规范配置。
- 新增子应用专属配置：在模板中添加qiankun生命周期（bootstrap/mount/unmount）、webpack适配qiankun的基础配置（如设置`publicPath`），并在模板说明中注明这些专属部分。

#### 第六步：CLI接入子应用模板与整合测试
- 在通用CLI中新增模板选项：更新`team-cli init`命令，增加“微前端子应用”选项，选择后会在通用规范配置的基础上，额外注入qiankun相关代码和配置。
- 端到端测试：从CLI初始化子应用模板，到代码编写、Lint校验、提交代码，完整流程测试，确保通用功能与专属模板无缝衔接。

### 四、下一步交付物提议
为了避免后续开发中“通用功能”与“专属功能”边界模糊，我可以帮你整理一份 **《通用功能与专属功能拆分清单》**，明确每个功能模块的归属、核心作用、适配场景和依赖关系，方便你后续开发时聚焦优先级。需要我现在帮你梳理这份清单吗？


----------------

# 通用功能与专属功能拆分清单（可编辑版）
## 文档说明
本文档用于明确微前端子应用模板工具链中“通用功能”与“专属功能”的边界、开发优先级及依赖关系，支持团队内同步分工、细化开发任务，可根据实际需求调整表格内容（如补充备注、修改优先级）。


## 一、通用功能模块（优先开发）
| 一级模块         | 二级具体模块                          | 核心作用                                                                 | 适配场景                     | 依赖关系                                  | 可独立使用 | 开发优先级 | 前置条件                          |
|------------------|---------------------------------------|--------------------------------------------------------------------------|------------------------------|-------------------------------------------|------------|------------|-----------------------------------|
| 1. 规范规则库    | 1.1 @team/eslint-config-base          | 提供通用JS/TS规则（变量命名、代码复杂度、import排序）                     | 所有前端项目                 | 依赖 `eslint`、`eslint-plugin-import`     | ✅          | P0（核心） | 无，可优先启动                    |
|                  | 1.2 @team/eslint-config-vue3          | 继承base包，新增Vue3专属规则（模板语法校验、组件命名）                    | Vue3技术栈项目（含子应用）   | 依赖 `@team/eslint-config-base`、`eslint-plugin-vue` | ✅          | P0（核心） | 完成 1.1 @team/eslint-config-base 开发 |
|                  | 1.3 @team/stylelint-config            | 提供通用CSS/SCSS规则（样式顺序、命名规范、禁止 !important）              | 所有前端项目                 | 依赖 `stylelint`、`stylelint-config-standard` | ✅          | P1（次要） | 无，可与1.1并行开发                |
|                  | 1.4 @team/prettier-config             | 统一代码格式化规则（缩进、引号、换行符），避免与Lint规则冲突              | 所有前端项目                 | 依赖 `prettier`、`eslint-config-prettier` | ✅          | P1（次要） | 完成 1.1 @team/eslint-config-base 开发 |
|                  | 1.5 @team/commitlint-config           | 统一Git提交信息格式（Angular规范：feat/fix/docs+描述）                  | 所有前端项目                 | 依赖 `commitlint`、`@commitlint/cli`       | ✅          | P1（次要） | 无，可独立开发                    |
| 2. CLI工具核心   | 2.1 team-cli init（通用版）           | 交互式生成Lint配置文件、安装规范包、添加lint脚本                          | 所有需接入规范的项目         | 依赖 `inquirer`、`ejs`                   | ✅          | P0（核心） | 完成 1.1-1.2 规范包开发           |
|                  | 2.2 team-cli lint fix                 | 一键扫描+自动修复可修复的Lint错误（缩进、空格等）                        | 所有已接入规范的项目         | 依赖 1.1-1.4 通用规范包                   | ✅          | P1（次要） | 完成 2.1 team-cli init（通用版）开发 |
|                  | 2.3 team-cli check-update             | 检测CLI及规范包版本，提示更新                                            | CLI启动时、用户主动触发       | 依赖 `npm-registry-client`                | ✅          | P2（后续） | 完成 2.1 team-cli init（通用版）开发 |
| 3. 提交规范集成  | 3.1 husky通用配置生成                 | 自动生成.husky目录、commit-msg钩子，关联commitlint配置                    | 所有前端项目                 | 依赖 `husky`、`@team/commitlint-config`   | ✅          | P1（次要） | 完成 1.5 @team/commitlint-config 开发 |
| 4. 存量项目修复  | 4.1 规范依赖检测与安装                | 扫描存量项目，自动安装缺失的通用规范包                                    | 所有未接入规范的存量项目     | 依赖 `team-cli` 核心、`pnpm`              | ✅          | P2（后续） | 完成 2.1 team-cli init（通用版）开发 |
|                  | 4.2 配置文件生成与修复                | 为存量项目补全缺失的Lint配置文件                                          | 所有未接入规范的存量项目     | 依赖 `team-cli` 核心、`ejs`               | ✅          | P2（后续） | 完成 4.1 规范依赖检测与安装 开发   |


## 二、微前端子应用专属功能模块（后续开发）
| 一级模块         | 二级具体模块                          | 核心作用                                                                 | 适配场景                     | 依赖关系                                  | 可独立使用 | 开发优先级 | 前置条件                          |
|------------------|---------------------------------------|--------------------------------------------------------------------------|------------------------------|-------------------------------------------|------------|------------|-----------------------------------|
| 1. 子应用模板核心 | 1.1 基础目录结构                      | 预设子应用必备目录（src/views、src/router、src/main.js），剥离业务代码     | 微前端子应用                 | 依赖 1.2 @team/eslint-config-vue3         | ❌          | P1（次要） | 完成 1.2 @team/eslint-config-vue3 开发 |
|                  | 1.2 Vue3基础模板                      | 提供入口组件（App.vue）、路由基础配置（含404页面）                        | 微前端子应用                 | 依赖 `vue`、`vue-router`                  | ❌          | P1（次要） | 无，可与1.1并行开发                |
| 2. webpack专属配置 | 2.1 qiankun适配配置                   | 配置webpack的publicPath（动态适配主应用）、输出格式（umd）                | 微前端子应用                 | 依赖 `webpack`、`webpack-chain`（可选）   | ❌          | P1（次要） | 完成 1.1 子应用基础目录结构 开发   |
|                  | 2.2 子应用打包优化                    | 预设代码分割（splitChunks）、Tree-Shaking配置                            | 微前端子应用                 | 依赖 `webpack`                            | ❌          | P2（后续） | 完成 2.1 qiankun适配配置 开发     |
| 3. qiankun生命周期集成 | 3.1 生命周期函数导出              | 在main.js中预设bootstrap/mount/unmount函数，适配qiankun加载逻辑          | 微前端子应用                 | 依赖 `qiankun`                             | ❌          | P1（次要） | 完成 1.2 Vue3基础模板 开发        |
| 4. CLI模板扩展   | 4.1 team-cli init --template qiankun  | 新增“微前端子应用”选项，加载专属模板并注入qiankun配置                    | 子应用初始化场景             | 依赖 2.1 team-cli init（通用版）、子应用模板包 | ❌          | P1（次要） | 完成 1.1-1.2 子应用模板核心 开发   |


## 三、核心依赖关系说明
1. **单向依赖原则**：专属功能仅依赖通用功能，通用功能不依赖任何专属功能，确保通用模块可独立落地。
2. **优先级逻辑**：P0（核心）需优先完成，是后续功能的基础；P1（次要）可在P0完成后并行开发；P2（后续）可根据团队需求延后迭代。
3. **扩展无侵入**：新增专属功能（如子应用新配置）时，无需修改通用模块代码，仅通过“CLI参数扩展”“模板包引入”实现对接。


## 四、文件使用说明
1. **编辑权限**：团队成员可根据开发进度修改“开发优先级”“前置条件”列，或在表格末尾新增“备注”列补充细节（如技术难点、负责人）。
2. **分工参考**：可按“一级模块”拆分任务（如A负责规范规则库、B负责CLI工具核心），依据“前置条件”规划开发顺序。
3. **版本管理**：建议将此文件存入项目仓库（如docs目录），通过Git提交记录跟踪修改，确保团队信息同步。


### 下一步交付物提议
如果需要进一步落地开发，我可以帮你基于这份清单生成 **《通用功能模块开发任务分解表》**，把每个P0/P1级通用模块拆分成“具体开发步骤、预期输出、技术栈细节”（如1.1 @team/eslint-config-base 拆分为“初始化包结构、编写规则配置、测试规则有效性”），方便你分配具体开发任务。需要我现在帮你梳理吗？